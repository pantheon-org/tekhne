# Task Definition

## Overview

Mise tasks are defined in `mise.toml` under the `[tasks]` section or as standalone files in `.mise/tasks/`.

## Inline Task Definition

```toml
[tasks.build]
description = "Build the project"
run = "npm run build"

[tasks.test]
description = "Run tests"
run = [
  "npm run lint",
  "npm run test:unit",
  "npm run test:integration"
]
depends = ["build"]
```

## File-Based Tasks

Create executable files in `.mise/tasks/`:

```bash
#!/usr/bin/env bash
# mise description="Deploy to production"
# mise depends=["build", "test"]
# mise alias="deploy:prod"

echo "Deploying..."
./scripts/deploy.sh --env production
```

## Task Properties

- `description`: Human-readable task description
- `run`: Command(s) to execute (string or array)
- `depends`: Tasks that must run first
- `alias`: Alternative name for the task
- `env`: Environment variables specific to this task
- `dir`: Working directory for task execution
- `sources`: Files that trigger task execution when changed
- `outputs`: Files generated by the task

## Multi-Command Tasks

```toml
[tasks.ci]
run = [
  "mise run lint",
  "mise run test",
  "mise run build"
]
```

## Task Arguments

Pass arguments to tasks:

```bash
mise run deploy -- --dry-run --env staging
```

Access in task:

```toml
[tasks.deploy]
run = "./deploy.sh $@"
```

## Best Practices

1. **Descriptive Names**: Use clear, action-oriented names
2. **Single Responsibility**: Each task should do one thing well
3. **Composability**: Build complex tasks from simple ones using `depends`
4. **Documentation**: Always include descriptions
5. **Idempotency**: Tasks should be safe to run multiple times

## Common Patterns

### Pre/Post Hooks

```toml
[tasks.deploy]
run = "./scripts/deploy.sh"
depends = ["pre-deploy"]

[tasks.pre-deploy]
run = [
  "mise run test",
  "mise run build"
]

[tasks.post-deploy]
run = "./scripts/notify-team.sh"
```

### Conditional Execution

```bash
#!/usr/bin/env bash
# mise description="Deploy if tests pass"

if mise run test; then
  mise run deploy
else
  echo "Tests failed, deployment cancelled"
  exit 1
fi
```

### Multi-Stage Tasks

```toml
[tasks.release]
depends = ["test", "build", "version", "publish"]

[tasks.version]
run = "npm version patch"

[tasks.publish]
run = "npm publish"
```
